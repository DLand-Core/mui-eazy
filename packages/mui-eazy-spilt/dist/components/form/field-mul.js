import{__spreadArray as e,__assign as o}from"../../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.9.6_tslib@2.6.2_typescript@5.3.3/node_modules/tslib/tslib.es6.js";import{j as n}from"../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js";import{Stack as i,IconButton as r,Button as t,Typography as l}from"@mui/material";import{useState as c,useEffect as a}from"react";import{useFormContext as d,Controller as s}from"../../node_modules/.pnpm/react-hook-form@7.45.4_react@18.2.0/node_modules/react-hook-form/dist/index.esm.js";import{uuidv4 as u}from"../../utils/uuidv4.js";import{useGetField as m}from"../../hooks/use-get-field.js";import{Iconify as f}from"../iconify/iconify.js";function p(p){var v=p.name,x=p.childFieldConfig,h=p.mulType,g=void 0===h?"one":h,j=p.addLabel,b=p.itemFieldConfig,k=d(),y=k.setValue,_=k.getValues,C=k.unregister,F=k.register,w=d().control,D=_(v),V=c([{id:u(),label:v}]),B=V[0],A=V[1];a((function(){var e;D&&Array.isArray(D)&&A(null===(e=null==D?void 0:D.map)||void 0===e?void 0:e.call(D,(function(){return{id:u(),label:v}})))}),[]);var I,S=m(),z=B.map((function(t,l){var c,a=t.id,d="".concat(v,".").concat(l);if("one"==g)c=S(d,x||{label:(null==b?void 0:b.placeholder)||(null==b?void 0:b.label),fieldConfig:b||p}),I=n.jsxs(i,{sx:{marginBottom:"10px"},direction:"row",children:[c,n.jsx(r,{sx:{width:"51px",height:"51px"},onClick:function(o){if(!(B.length<=1)){var n=e([],B,!0),i=B.findIndex((function(e){return e.id===a}));n.splice(i,1);var r=e([],_(v),!0);for(var t in r.splice(i,1),C("".concat(v),{keepDefaultValue:!1,keepDirty:!1}),n)C("".concat(v,".").concat(t),{keepDefaultValue:!1,keepDirty:!1});for(var t in F("".concat(v)),n)F("".concat(v,".").concat(t));y("".concat(v),r),r.forEach((function(e,o){y("".concat(v,".").concat(o),e)})),A(n)}},children:n.jsx(f,{icon:"icon-park-outline:delete"})})]},a);else{if(!x)return n.jsx(n.Fragment,{children:"error"});c=Object.entries(x).map((function(e){var r,t,c=e[0],a=e[1];a.name="".concat(d,".").concat(c);var s=o({},a);return(null===(r=a.labelMap)||void 0===r?void 0:r[l])&&(s.label=null===(t=a.labelMap)||void 0===t?void 0:t[l]),n.jsx(i,{sx:{mb:2,width:"100%"},direction:"row",children:S("".concat(d,".").concat(c),s)},a.name)})),I=n.jsxs(i,{children:[c,n.jsx(i,{sx:{mb:2},direction:"row",children:n.jsx(r,{sx:{},onClick:function(o){if(!(B.length<=1)){var n=e([],B,!0),i=B.findIndex((function(e){return e.id===a}));n.splice(i,1);var r=e([],_(v),!0);for(var t in r.splice(i,1),n)C("".concat(v,".").concat(t),{keepDefaultValue:!1,keepDirty:!1});for(var t in n)F("".concat(v,".").concat(t));y("".concat(v),r),r.forEach((function(e,o){y("".concat(v,".").concat(o),e)})),A(n)}},children:n.jsx(f,{icon:"icon-park-outline:delete"})})})]},a)}return I}));return n.jsx(n.Fragment,{children:n.jsx(s,{name:v,control:w,render:function(o){var i,r,c=o.fieldState.error;return n.jsxs(n.Fragment,{children:[z,n.jsx("div",{children:n.jsx(t,{onClick:function(o){A(e(e([],B,!0),[{id:u(),label:v}],!1))},startIcon:n.jsx(f,{color:"#256CCB",width:"32px",height:"32px",icon:"formkit:add"}),children:n.jsx(l,{fontSize:"14px",color:"#256CCB",children:j||"add ".concat(v)})})}),((null===(i=null==c?void 0:c.root)||void 0===i?void 0:i.message)||(null==c?void 0:c.message))&&n.jsx("div",{style:{color:"#FF5630",lineHeight:1.5,fontSize:"0.75rem",fontWeight:400,textAlign:"left",marginRight:"14px",marginBottom:"0",marginLeft:"14px"},children:(null==c?void 0:c.message)||(null===(r=null==c?void 0:c.root)||void 0===r?void 0:r.message)})]})}})})}export{p as default};
