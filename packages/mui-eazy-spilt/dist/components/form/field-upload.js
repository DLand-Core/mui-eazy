import{__rest as e,__assign as r,__spreadArray as o}from"../../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.9.6_tslib@2.6.2_typescript@5.3.3/node_modules/tslib/tslib.es6.js";import{j as t}from"../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js";import{useFormContext as n,Controller as l}from"../../node_modules/.pnpm/react-hook-form@7.45.4_react@18.2.0/node_modules/react-hook-form/dist/index.esm.js";import{useEffect as i}from"react";import{UploadBtn as m}from"../upload/upload-btn.js";import{UploadDrag as a}from"../upload/upload-drag/index.js";import u from"../../node_modules/.pnpm/@mui_material@5.15.5_@emotion_react@11.5.0_@emotion_styled@11.6.0_@types_react@18.2.51_react-dom@18.2.0_react@18.2.0/node_modules/@mui/material/FormHelperText/FormHelperText.js";function s(o){var i=o.name,a=e(o,["name"]),u=n().control;return t.jsx(l,{name:i,control:u,render:function(e){var o=e.field,n=e.fieldState.error;return t.jsx(m,r({files:o.value,error:!!n},a))}})}function p(m){var s=m.accept,p=m.name,d=m.multiple,c=m.helperText,f=m.isCrop,_=e(m,["accept","name","multiple","helperText","onUpload","isCrop"]),x=n(),j=x.control,v=x.setValue,g=x.getValues,h=x.watch,b=x.trigger;return i((function(){var e=h((function(e,r){r.name==p&&b(p)}));return function(){return e.unsubscribe()}}),[]),t.jsx(l,{name:p,control:j,render:function(e){var n=e.field,l=e.fieldState.error;return t.jsx(a,r({isCrop:f,multiple:d,accept:s||{"image/*":[]},files:d?n.value:n.value?[n.value]:[],error:!!l,onOrder:function(e){v(p,e)},onAdd:function(e){if(d){var r=g(p)||[];v(p,o(o([],r,!0),[e],!1))}else v(p,e)},onDel:function(e){if(d){var r=g(p),o=r.findIndex((function(r){return r==e}));r.splice(o,1),v(p,r)}else v(p,null)},helperText:(!!l||c)&&t.jsx(u,{error:!!l,sx:{px:2},children:l?null==l?void 0:l.message:c})},_))}})}export{p as FieldUpload,s as FieldUploadBox};
