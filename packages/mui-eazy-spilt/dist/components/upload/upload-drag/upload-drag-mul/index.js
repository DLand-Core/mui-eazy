import{__rest as e,__assign as o,__awaiter as t,__spreadArray as r,__generator as n}from"../../../../node_modules/.pnpm/@rollup_plugin-typescript@11.1.6_rollup@4.9.6_tslib@2.6.2_typescript@5.3.3/node_modules/tslib/tslib.es6.js";import{j as i}from"../../../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js";import{CircularProgress as l}from"@mui/material";import{useState as s,useEffect as a}from"react";import c from"../cropModal.js";import{useDropzone as d}from"../../../../node_modules/.pnpm/react-dropzone@14.2.3_react@18.2.0/node_modules/react-dropzone/dist/es/index.js";import{useBoolean as m}from"../../../../hooks/use-boolean.js";import p from"../../ic-eva_cloud-upload-fill.svg.js";import u from"./preview-multi-file.js";import _ from"../../../../node_modules/.pnpm/@mui_material@5.15.5_@emotion_react@11.5.0_@emotion_styled@11.6.0_@types_react@18.2.51_react-dom@18.2.0_react@18.2.0/node_modules/@mui/material/Stack/Stack.js";import f from"../../../../node_modules/.pnpm/@mui_material@5.15.5_@emotion_react@11.5.0_@emotion_styled@11.6.0_@types_react@18.2.51_react-dom@18.2.0_react@18.2.0/node_modules/@mui/material/Box/Box.js";import x from"../../../../node_modules/.pnpm/@mui_material@5.15.5_@emotion_react@11.5.0_@emotion_styled@11.6.0_@types_react@18.2.51_react-dom@18.2.0_react@18.2.0/node_modules/@mui/material/Typography/Typography.js";import h from"../../../../node_modules/.pnpm/@mui_material@5.15.5_@emotion_react@11.5.0_@emotion_styled@11.6.0_@types_react@18.2.51_react-dom@18.2.0_react@18.2.0/node_modules/@mui/material/Button/Button.js";import{alpha as v}from"@mui/system";function j(j){var y=this,g=j.onDel,b=j.onAdd,A=j.onRemoveAll,w=j.uploadAction,R=j.onOrder,C=j.validateFunc,D=j.disabled,k=j.multiple,F=void 0!==k&&k,S=j.error,T=j.placeholder,z=j.helperText,B=j.sx,I=j.files,O=j.isCrop,E=e(j,["onDel","onDelete","onUpload","onRemove","onAdd","onRemoveAll","uploadAction","onOrder","validateFunc","disabled","multiple","error","placeholder","helperText","sx","files","thumbnail","isCrop"]),L=s(""),P=L[0],U=L[1],G=s(!1),M=G[0],N=G[1],W=s(""),q=W[0],H=W[1],J=m(!1),K=s([]),Q=K[0],V=K[1],X=s(I||[]),Y=X[0],Z=X[1];a((function(){I&&Z(I)}),[I]);var $=d(o({multiple:F,disabled:D,onDropAccepted:function(){document.body.focus()},onDrop:function(e){return t(y,void 0,void 0,(function(){var o;return n(this,(function(t){switch(t.label){case 0:return O?(n=e[0],i=function(o){U(o),H(e[0].name),N(!0)},(l=new FileReader).onload=function(){i(l.result)},l.readAsDataURL(n),[3,3]):[3,1];case 1:return J.onTrue(),[4,null==w?void 0:w(e[0]).finally((function(){J.onFalse()}))];case 2:(o=t.sent())&&(null==b||b(o),V(r(r([],Q,!0),e,!0))),t.label=3;case 3:return[2]}var n,i,l}))}))}},E)),ee=$.getRootProps,oe=$.getInputProps,te=$.isDragActive,re=$.isDragReject,ne=Y.length,ie=re||!!S,le=i.jsxs(_,{spacing:3,alignItems:"center",justifyContent:"center",flexWrap:"wrap",children:[i.jsx(f,{component:"img",src:p,sx:o({width:52,height:52,flexShrink:0},B)}),i.jsx(_,{spacing:1,sx:{textAlign:"center"},children:T||i.jsx(x,{sx:{color:"#919EAB",fontSize:"14px"},children:"Drag and drop or click to choose files"})})]}),se=(ne||Y.length>0)&&i.jsxs(i.Fragment,{children:[i.jsx(f,{sx:{my:3},children:i.jsx(u,{moveCard:function(e,o){var t=r([],Y,!0),n=t[e];t[e]=t[o],t[o]=n,null==R||R(t)},onRemove:function(e,o){"string"==typeof e&&(null==g||g(e),"number"==typeof o&&(Y.splice(o,1),Q.splice(o,1),Z(r([],Y,!0)),V(r([],Q,!0))))},fileNameList:Y})}),i.jsx(_,{direction:"row",justifyContent:"flex-end",spacing:1.5,children:A&&i.jsx(h,{color:"inherit",variant:"outlined",size:"small",onClick:A,children:"Remove All"})})]});return i.jsxs(f,{sx:o({width:1,position:"relative"},B),children:[i.jsxs(f,o({},ee(),{sx:o(o(o({p:5,outline:"none",borderRadius:"var(--radius-15, 12px)",cursor:"pointer",overflow:"hidden",position:"relative",bgcolor:function(e){return v(e.palette.grey[500],.08)},border:"1px dashed var(--Scaling-Grey2, #696969)",transition:function(e){return e.transitions.create(["opacity","padding"])},"&:hover":{opacity:.72}},te&&{opacity:.72}),D&&{opacity:.48,pointerEvents:"none"}),ie&&{color:"error.main",borderColor:"error.main",bgcolor:function(e){return v(e.palette.error.main,.08)}}),children:[i.jsx("input",o({},oe())),le]})),J.value&&i.jsx(f,{sx:{position:"absolute",top:-10,bottom:-10,left:-10,right:-10,background:"rgba(255,255,255,0.1)",backdropFilter:"blur(5px)",boxShadow:"inset 0 0 6px rgba(255, 255, 255, 0.2)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:10},children:i.jsx(l,{color:"inherit"})}),i.jsx(c,{name:q,onComplete:function(e){return t(y,void 0,void 0,(function(){var o;return n(this,(function(t){switch(t.label){case 0:return J.onTrue(),[4,null==w?void 0:w(e).finally((function(){J.onFalse()}))];case 1:return(o=t.sent())&&(null==b||b(o),V(r(r([],Q,!0),[e],!1))),[2]}}))}))},src:P,open:M,setOpen:function(){M&&(N(!1),U(""),H(""))},validateFunc:C}),z&&z,se]})}export{j as UploadDragMul};
